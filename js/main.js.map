{
  "version": 3,
  "file": "main.js",
  "sourceRoot": "",
  "sources": [
    "main.coffee"
  ],
  "names": [],
  "mappings": ";AAAA;AAAA,MAAA,QAAA,EAAA,cAAA,EAAA,IAAA,EAAA,KAAA,EAAA,OAAA,EAAA,MAAA,EAAA;;EAAM,OAAN,MAAA,KAAA;IACE,WAAa,CAAC,CAAD,EAAI,CAAJ,CAAA;MACX,IAAC,CAAA,CAAD,eAAK,IAAI;MACT,IAAC,CAAA,CAAD,eAAK,IAAI;IAFE;;IAIb,GAAK,CAAC,GAAD,CAAA;MACH,IAAC,CAAA,CAAD,IAAM,GAAG,CAAC;MACV,IAAC,CAAA,CAAD,IAAM,GAAG,CAAC;AACV,aAAO;IAHJ;;IAKL,IAAM,CAAA,CAAA;aAAG,IAAI,IAAJ,CAAS,IAAC,CAAA,CAAV,EAAa,IAAC,CAAA,CAAd;IAAH;;IAEM,OAAX,SAAW,CAAC,GAAD,EAAM,GAAN,CAAA;aACV,IAAI,IAAJ,CAAY,IAAI,CAAC,QAAR,GAAiB,CAAC,GAAA,GAAM,GAAP,CAAjB,GAA+B,GAAxC,EACK,IAAI,CAAC,QAAR,GAAiB,CAAC,GAAA,GAAM,GAAP,CAAjB,GAA+B,GADjC;IADU;;EAZd;;EAgBM,QAAN,MAAA,MAAA;IACE,WAAa,QAAA,EAAU,KAAV,EAAiB,MAAjB,CAAA;MAAC,IAAC,CAAA;MACb,IAAC,CAAA,GAAD,GAAO,IAAC,CAAA,MAAM,CAAC,UAAR,CAAmB,IAAnB;MACP,IAAC,CAAA,WAAD,GAAe,IAAC,CAAA,MAAM,CAAC,KAAR,GAAgB;MAC/B,IAAC,CAAA,YAAD,GAAgB,IAAC,CAAA,MAAM,CAAC,MAAR,GAAiB;MAEjC,IAAC,CAAA,OAAD,GAAW;MACX,IAAC,CAAA,YAAD,GAAgB,CAAA;MAChB,IAAC,CAAA,KAAD,GAAS,IAAI,IAAJ,CAAS,IAAC,CAAA,WAAD,GAAe,GAAxB,EAA6B,IAAC,CAAA,YAAD,GAAgB,GAA7C;MAET,IAAC,CAAA,MAAD,GACE;QAAA,OAAA,EAAS,IAAI,IAAJ,CAAS,CAAT,EAAY,CAAC,GAAb;MAAT;MAEF,IAAC,CAAA,MAAM,CAAC,gBAAR,CAAyB,WAAzB,EAAsC,CAAC,CAAC,CAAD,CAAA,GAAA;eACrC,CAAC,IAAC,CAAA,KAAK,CAAC,CAAR,EAAW,IAAC,CAAA,KAAK,CAAC,CAAlB,CAAA,GAAuB,CAAC,CAAC,CAAC,OAAH,EAAY,CAAC,CAAC,OAAd;MADc,CAAD,CAAtC,EAEG,KAFH;MAIA,IAAC,CAAA,MAAM,CAAC,gBAAR,CAAyB,OAAzB,EAAkC,CAAC,CAAC,CAAD,CAAA,GAAA;QAC9B,CAAC,CAAC;QACL,IAAG,IAAC,CAAA,YAAD,YAAyB,cAA5B;UACE,IAAG,CAAC,CAAC,QAAL;mBACE,IAAC,CAAA,YAAY,CAAC,OAAd,GAAwB,IAAI,CAAC,GAAL,CAAS,CAAT,EAAY,IAAC,CAAA,YAAY,CAAC,OAAd,GAAwB,CAAC,CAAC,MAAF,GAAW,GAA/C,EAD1B;WAAA,MAEK,IAAG,CAAC,CAAC,MAAL;mBACH,IAAC,CAAA,YAAY,CAAC,YAAd,GAA6B,IAAI,CAAC,GAAL,CAAS,CAAT,EAAY,IAAC,CAAA,YAAY,CAAC,YAAd,GAA6B,CAAC,CAAC,MAAF,GAAW,EAApD,EAD1B;WAAA,MAAA;mBAGH,IAAC,CAAA,YAAY,CAAC,YAAd,GAA6B,IAAI,CAAC,GAAL,CAAS,CAAT,EAAY,IAAC,CAAA,YAAY,CAAC,YAAd,GAA6B,CAAC,CAAC,MAAF,GAAW,EAApD,EAH1B;WAHP;;MAFiC,CAAD,CAAlC,EASG,KATH;IAhBW;;IA2Bb,SAAW,CAAC,WAAD,EAAc,MAAd,EAAsB,YAAtB,CAAA;AACb,UAAA;MAAI,MAAM,CAAC,KAAP,GAAe;MACf,GAAA,GAAM,IAAI,WAAJ,CAAgB,MAAhB;MACN,IAA0B,YAA1B;QAAG,GAAG,CAAC,kBAAP;;aACA,IAAC,CAAA,OAAO,CAAC,IAAT,CAAc,GAAd;IAJS;;IAMX,YAAc,CAAC,KAAD,CAAA;aAAW,IAAC,CAAA,OAAO,CAAC,MAAT,CAAgB,KAAhB,EAAuB,CAAvB;IAAX;;IAEd,KAAO,CAAA,CAAA;aAAM,IAAC,CAAA;IAAP;;IAEP,IAAM,CAAA,CAAA;MACD,IAAC,CAAA;MACD,IAAC,CAAA;aACJ,2BAAA,CAA4B,IAAC,CAAA,IAAI,CAAC,IAAN,CAAW,IAAX,CAA5B;IAHI;;IAKN,MAAQ,CAAA,CAAA;AACV,UAAA,GAAA,EAAA,CAAA,EAAA,GAAA,EAAA,MAAA,EAAA,GAAA,EAAA;AAAI;AAAA;MAAA,KAAA,iDAAA;;YAAmD;uBAAnD,MAAM,CAAC,MAAP,CAAc,GAAd;;MAAA,CAAA;;IADM;;IAGR,IAAM,CAAA,CAAA;AACR,UAAA,CAAA,EAAA,GAAA,EAAA,MAAA,EAAA,GAAA,EAAA;MAAI,IAAC,CAAA,GAAG,CAAC,SAAL,CAAe,CAAf,EAAkB,CAAlB,EAAqB,IAAC,CAAA,WAAtB,EAAmC,IAAC,CAAA,YAApC;MACA,IAAC,CAAA,GAAG,CAAC,MAAL,GAAc;AACd;AAAA;MAAA,KAAA,qCAAA;;qBAAG,MAAM,CAAC;MAAV,CAAA;;IAHI;;EA9CR;;EAmDM,UAAN,MAAA,QAAA;IACE,WAAa,CAAC,MAAD,CAAA;AACf,UAAA,GAAA,EAAA;MAAI,IAAC,CAAA,GAAD,sCAAoB,IAAI,IAAJ,CAAA;MACpB,IAAC,CAAA,KAAD,0CAAwB,IAAI,IAAJ,CAAA;MACxB,IAAC,CAAA,KAAD,GAAS,MAAM,CAAC;IAHL;;IAKb,MAAQ,CAAA,CAAA;MACN,MAAO,IAAA,YAAa,eAApB;QACE,IAAC,CAAA,KAAK,CAAC,GAAP,CAAW,IAAC,CAAA,KAAK,CAAC,MAAM,CAAC,OAAzB,EADF;;aAEA,IAAC,CAAA,GAAG,CAAC,GAAL,CAAS,IAAC,CAAA,KAAV;IAHM;;IAKR,UAAY,CAAC,SAAD,CAAA;aACV,IAAC,CAAA,GAAG,CAAC,CAAL,GAAS,IAAC,CAAA,KAAK,CAAC,YAAP,GAAsB,SAA/B,IACE,IAAC,CAAA,GAAG,CAAC,CAAL,GAAS,CAAC,SADZ,IAEE,IAAC,CAAA,GAAG,CAAC,CAAL,GAAS,IAAC,CAAA,KAAK,CAAC,WAAP,GAAqB,SAFhC,IAGE,IAAC,CAAA,GAAG,CAAC,CAAL,GAAS,CAAC;IAJF;;IAMZ,eAAiB,CAAA,CAAA;MACf,IAAC,CAAA,KAAK,CAAC,YAAP,GAAsB;aACtB,IAAC,CAAA,GAAD,GAAO,IAAC,CAAA,KAAK,CAAC;IAFC;;EAjBnB;;EAqBM,iBAAN,MAAA,eAAA,QAA6B,QAA7B;IACE,WAAa,CAAC,MAAD,CAAA;AACf,UAAA,GAAA,EAAA,IAAA,EAAA,IAAA,EAAA,IAAA,EAAA;WAAI,CAAM,MAAN;MACA,IAAC,CAAA,SAAD,GAAa;MACb,IAAC,CAAA,YAAD,+CAAsC;MACtC,IAAC,CAAA,YAAD,iDAAsC;MACtC,IAAC,CAAA,YAAD,iDAAsC;MACtC,IAAC,CAAA,YAAD,iDAAsC;MACtC,IAAC,CAAA,OAAD,4CAA4B;IAPjB;;IASb,WAAa,CAAC,MAAD,CAAA;MACX,MAAM,CAAC,MAAP,GAAgB;MAChB,MAAM,CAAC,KAAP,GAAe,IAAC,CAAA;aAChB,IAAC,CAAA,SAAS,CAAC,IAAX,CAAgB,IAAI,QAAJ,CAAa,MAAb,CAAhB;IAHW;;IAKb,cAAgB,CAAC,KAAD,CAAA;aAAW,IAAC,CAAA,SAAS,CAAC,MAAX,CAAkB,KAAlB,EAAyB,CAAzB;IAAX;;IAEhB,MAAQ,CAAA,CAAA;AACV,UAAA,CAAA,EAAA,GAAA,EAAA,CAAA,EAAA,CAAA,EAAA,GAAA,EAAA,QAAA,EAAA,GAAA,EAAA,IAAA,EAAA;MAAI,MAAO,IAAC,CAAA,SAAS,CAAC,MAAX,GAAoB,IAAC,CAAA,aAA5B;QACE,KAAS,8FAAT;UACE,IAAC,CAAA,WAAD,CAAa;YACX,GAAA,EAAQ,IAAC,CAAA,GAAG,CAAC,MADF;YAEX,KAAA,EAAO,IAAI,CAAC,SAAL,CAAe,CAAC,IAAC,CAAA,OAAjB,EAA0B,IAAC,CAAA,OAA3B;UAFI,CAAb;QADF,CADF;;AAMA;AAAA;MAAA,KAAA,kDAAA;;YAAyD;uBAAzD,QAAQ,CAAC,MAAT,CAAgB,GAAhB;;MAAA,CAAA;;IAPM;;IASR,IAAM,CAAA,CAAA;AACR,UAAA,CAAA,EAAA,GAAA,EAAA,QAAA,EAAA,GAAA,EAAA;AAAI;AAAA;MAAA,KAAA,qCAAA;;qBAAG,QAAQ,CAAC;MAAZ,CAAA;;IADI;;EA1BR;;EA6BM,WAAN,MAAA,SAAA,QAAuB,QAAvB;IACE,WAAa,CAAC,MAAD,CAAA;WACX,CAAM,MAAN;MACA,IAAC,CAAA,MAAD,GAAU,MAAM,CAAC;MACjB,IAAC,CAAA,WAAD,GAAe,IAAC,CAAA,MAAM,CAAC;MACvB,IAAC,CAAA,IAAD,GAAQ,IAAC,CAAA;MACT,IAAC,CAAA,IAAD,GAAQ,IAAC,CAAA,MAAM,CAAC;IALL;;IAOb,MAAQ,CAAC,GAAD,CAAA;WAAR,CAAA,MACE,CAAA;MACA,IAAC,CAAA,IAAD,GAAQ,IAAI,CAAC,GAAL,CAAS,CAAT,EAAY,IAAC,CAAA,MAAM,CAAC,YAAR,GAAuB,CAAC,IAAC,CAAA,IAAD,EAAA,GAAU,IAAC,CAAA,WAAZ,CAAnC;MACR,IAAG,IAAC,CAAA,UAAD,CAAY,GAAA,IAAO,IAAC,CAAA,IAAD,GAAQ,CAA3B,CAAH;eAAqC,IAAC,CAAA,MAAM,CAAC,cAAR,CAAuB,GAAvB,EAArC;;IAHM;;IAKR,IAAM,CAAA,CAAA;AACR,UAAA,KAAA,EAAA,MAAA,EAAA,MAAA,EAAA,MAAA,EAAA;MAAI,IAAC,CAAA,KAAK,CAAC,GAAG,CAAC,wBAAX,GAAsC;MACtC,IAAC,CAAA,KAAK,CAAC,GAAG,CAAC,WAAX,GAAyB,IAAC,CAAA,IAAD,GAAQ,IAAC,CAAA;MAElC,MAAA,GAAS,IAAC,CAAA,IAAD,GAAQ,IAAC,CAAA;MAClB,MAAA,GAAS,CAAC,GAAD,EAAM,GAAN,EAAW,CAAX;MACT,MAAA,GAAS,CAAC,GAAD,EAAM,GAAN,EAAW,CAAX;MACT,KAAA,GAAQ,CACN,CAAC,MAAM,CAAC,CAAD,CAAN,GAAY,MAAM,CAAC,CAAD,CAAnB,CAAA,GAA0B,MAA1B,GAAmC,MAAM,CAAC,CAAD,CAAN,GAAY,MADzC,EAEN,CAAC,MAAM,CAAC,CAAD,CAAN,GAAY,MAAM,CAAC,CAAD,CAAnB,CAAA,GAA0B,MAA1B,GAAmC,MAAM,CAAC,CAAD,CAAN,GAAY,MAFzC,EAGN,CAAC,MAAM,CAAC,CAAD,CAAN,GAAY,MAAM,CAAC,CAAD,CAAnB,CAAA,GAA0B,MAA1B,GAAmC,MAAM,CAAC,CAAD,CAAN,GAAY,MAHzC;MAMR,IAAA,GAAO,IAAC,CAAA,KAAK,CAAC,GAAG,CAAC,oBAAX,CAAgC,IAAC,CAAA,GAAG,CAAC,CAArC,EAAwC,IAAC,CAAA,GAAG,CAAC,CAA7C,EAAgD,CAAhD,EAAmD,IAAC,CAAA,GAAG,CAAC,CAAxD,EAA2D,IAAC,CAAA,GAAG,CAAC,CAAhE,EAAmE,IAAC,CAAA,IAApE;MACP,IAAI,CAAC,YAAL,CAAkB,GAAlB,EAAuB,CAAA,KAAA,CAAA,CAAQ,KAAK,CAAC,CAAD,CAAb,CAAA,EAAA,CAAA,CAAqB,KAAK,CAAC,CAAD,CAA1B,CAAA,EAAA,CAAA,CAAkC,KAAK,CAAC,CAAD,CAAvC,CAAA,MAAA,CAAvB;MACA,IAAI,CAAC,YAAL,CAAkB,GAAlB,EAAuB,aAAvB;MACA,IAAC,CAAA,KAAK,CAAC,GAAG,CAAC,SAAX,GAAuB;MAEpB,IAAC,CAAA,KAAK,CAAC,GAAG,CAAC;MACd,IAAC,CAAA,KAAK,CAAC,GAAG,CAAC,GAAX,CAAe,IAAC,CAAA,GAAG,CAAC,CAApB,EAAuB,IAAC,CAAA,GAAG,CAAC,CAA5B,EAA+B,IAAC,CAAA,IAAhC,EAAsC,CAAtC,EAAyC,GAAA,GAAM,IAAI,CAAC,EAApD;aACG,IAAC,CAAA,KAAK,CAAC,GAAG,CAAC;IApBV;;EAbR;;EAmCA,MAAA,GAAS,QAAQ,CAAC,cAAT,CAAwB,QAAxB;;EACT,IAAA,GAAO,IAAI,KAAJ,CAAU,MAAV,EAAkB,GAAlB,EAAuB,GAAvB;;EACP,MAAM,CAAC,IAAP,GAAc;;EAEd,IAAI,CAAC,SAAL,CAAe,cAAf,EAA+B;IAC7B,GAAA,EAAK,IAAI,IAAJ,CAAS,GAAT,EAAc,GAAd,CADwB;IAE7B,YAAA,EAAc,EAFe;IAG7B,YAAA,EAAc,EAHe;IAI7B,OAAA,EAAS;EAJoB,CAA/B,EAKG,IALH;;EAOG,IAAI,CAAC;AAnKR",
  "sourcesContent": [
    "class Vec2\r\n  constructor: (x, y) ->\r\n    @x = x ? 0\r\n    @y = y ? 0\r\n\r\n  add: (vec) ->\r\n    @x += vec.x\r\n    @y += vec.y\r\n    return @\r\n\r\n  copy: -> new Vec2 @x, @y\r\n\r\n  @getRandom: (min, max) ->\r\n    new Vec2 do Math.random * (max - min) + min,\r\n      do Math.random * (max - min) + min\r\n\r\nclass World\r\n  constructor: (@canvas, width, height) ->\r\n    @ctx = @canvas.getContext '2d'\r\n    @canvasWidth = @canvas.width = width\r\n    @canvasHeight = @canvas.height = height\r\n\r\n    @objects = []\r\n    @controllable = {}\r\n    @mouse = new Vec2 @canvasWidth * 0.5, @canvasHeight * 0.5\r\n\r\n    @params =\r\n      gravity: new Vec2 0, -0.2\r\n\r\n    @canvas.addEventListener \"mousemove\", ((e) =>\r\n      [@mouse.x, @mouse.y] = [e.offsetX, e.offsetY]\r\n    ), no\r\n\r\n    @canvas.addEventListener \"wheel\", ((e) =>\r\n      do e.preventDefault\r\n      if @controllable instanceof ParticleSystem\r\n        if e.shiftKey\r\n          @controllable.scatter = Math.max 0, @controllable.scatter - e.deltaY / 500\r\n        else if e.altKey\r\n          @controllable.particleSize = Math.max 0, @controllable.particleSize - e.deltaY / 20\r\n        else\r\n          @controllable.particleLife = Math.max 1, @controllable.particleLife - e.deltaY / 10\r\n    ), no\r\n\r\n  addObject: (constructor, config, controllable) ->\r\n    config.world = @\r\n    obj = new constructor config\r\n    do obj.setControllable if controllable\r\n    @objects.push obj\r\n\r\n  removeObject: (index) -> @objects.splice index, 1\r\n\r\n  start: -> do @tick\r\n\r\n  tick: ->\r\n    do @update\r\n    do @draw\r\n    webkitRequestAnimationFrame @tick.bind @\r\n\r\n  update: ->\r\n    object.update ind for object, ind in @objects when object\r\n\r\n  draw: ->\r\n    @ctx.clearRect 0, 0, @canvasWidth, @canvasHeight\r\n    @ctx.global = 1\r\n    do object.draw for object in @objects\r\n\r\nclass _Object\r\n  constructor: (config) ->\r\n    @loc = config.loc ? new Vec2\r\n    @speed = config.speed ? new Vec2\r\n    @world = config.world\r\n\r\n  update: ->\r\n    unless @ instanceof ParticleSystem\r\n      @speed.add @world.params.gravity\r\n    @loc.add @speed\r\n\r\n  notVisible: (threshold) ->\r\n    @loc.y > @world.canvasHeight + threshold or\r\n      @loc.y < -threshold or\r\n      @loc.x > @world.canvasWidth + threshold or\r\n      @loc.x < -threshold\r\n\r\n  setControllable: ->\r\n    @world.controllable = @\r\n    @loc = @world.mouse\r\n\r\nclass ParticleSystem extends _Object\r\n  constructor: (config) ->\r\n    super config\r\n    @particles = []\r\n    @maxParticles = config.maxParticles ? 300\r\n    @particleLife = config.particleLife ? 60\r\n    @particleSize = config.particleSize ? 24\r\n    @creationRate = config.creationRate ? 3\r\n    @scatter = config.scatter ? 1.3\r\n\r\n  addParticle: (config) ->\r\n    config.system = @\r\n    config.world = @world\r\n    @particles.push new Particle config\r\n\r\n  removeParticle: (index) -> @particles.splice index, 1\r\n\r\n  update: ->\r\n    unless @particles.length > @maxParticles\r\n      for i in [0..@creationRate]\r\n        @addParticle {\r\n          loc: do @loc.copy,\r\n          speed: Vec2.getRandom -@scatter, @scatter\r\n        }\r\n    particle.update ind for particle, ind in @particles when particle\r\n\r\n  draw: ->\r\n    do particle.draw for particle in @particles\r\n\r\nclass Particle extends _Object\r\n  constructor: (config) ->\r\n    super config\r\n    @system = config.system\r\n    @initialLife = @system.particleLife\r\n    @life = @initialLife\r\n    @size = @system.particleSize\r\n\r\n  update: (ind) ->\r\n    do super\r\n    @size = Math.max 0, @system.particleSize * (@life-- / @initialLife)\r\n    if @notVisible 100 or @life < 0 then @system.removeParticle ind\r\n\r\n  draw: ->\r\n    @world.ctx.globalCompositeOperation = \"lighter\"\r\n    @world.ctx.globalAlpha = @life / @initialLife\r\n\r\n    colorK = @life / @initialLife\r\n    color0 = [255, 239, 0]\r\n    color1 = [255, 108, 0]\r\n    color = [\r\n      (color1[0] - color0[0]) * colorK + color0[0] * colorK,\r\n      (color1[1] - color0[1]) * colorK + color0[1] * colorK,\r\n      (color1[2] - color0[2]) * colorK + color0[2] * colorK\r\n    ]\r\n\r\n    grad = @world.ctx.createRadialGradient @loc.x, @loc.y, 0, @loc.x, @loc.y, @size\r\n    grad.addColorStop 0.0, \"rgba(#{color[0]}, #{color[1]}, #{color[2]}, 0.5)\"\r\n    grad.addColorStop 1.0, \"transparent\"\r\n    @world.ctx.fillStyle = grad\r\n\r\n    do @world.ctx.beginPath\r\n    @world.ctx.arc @loc.x, @loc.y, @size, 0, 2.0 * Math.PI\r\n    do @world.ctx.fill\r\n\r\ncanvas = document.getElementById \"canvas\"\r\ntest = new World canvas, 600, 600\r\nwindow.test = test\r\n\r\ntest.addObject ParticleSystem, {\r\n  loc: new Vec2 200, 400\r\n  particleSize: 30\r\n  particleLife: 55\r\n  scatter: 0.4\r\n}, on\r\n\r\ndo test.start\r\n"
  ]
}